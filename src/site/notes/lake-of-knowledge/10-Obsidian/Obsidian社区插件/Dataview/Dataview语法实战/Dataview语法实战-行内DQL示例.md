---
{"uid":20230914144952,"title":"Dataview è¯­æ³•å®žæˆ˜ï¼šè¡Œå†… DQL ç¤ºä¾‹","tags":["Obsidian","Dataview","ç¤ºä¾‹"],"description":"ä»‹ç»äº† Dataview çš„ä¸€äº›åŸºç¡€çš„ Inline DQL çš„ä½¿ç”¨å®žä¾‹","author":null,"type":"other","draft":false,"editable":false,"modified":20231008001546,"dg-publish":true,"permalink":"/lake-of-knowledge/10-obsidian/obsidian/dataview/dataview/dataview-dql/","dgPassFrontmatter":true}
---


# Dataview è¯­æ³•å®žæˆ˜ï¼šè¡Œå†… DQL ç¤ºä¾‹

ä¸Žå¸¦æœ‰ä¸‰ä¸ªåå¼•å·çš„ä»£ç å—æŸ¥è¯¢ä¸åŒï¼Œè¡Œå†…æŸ¥è¯¢ç”¨äºŽç¬”è®°çš„æ–‡æœ¬ã€æ ‡é¢˜ä¸­ï¼Œè€Œä¸æ˜¯ä¸ºå®ƒä»¬éœ€è¦ä¸€ä¸ªå­¤ç«‹çš„å—ã€‚è¡Œå†…æŸ¥è¯¢çš„ç»“æžœå¯ä»¥éšç€æŸ¥è¯¢å€¼çš„æ”¹å˜åŠ¨æ€æ”¹å˜ã€‚

> [!tip] è¡Œå†…æŸ¥è¯¢æ€»æ˜¯åªäº§ç”Ÿä¸€ä¸ªå€¼ã€‚
> é‰´äºŽæ­¤ï¼Œæˆ‘ä»¬æ— æ³•ä½¿ç”¨è¡Œå†…æŸ¥è¯¢è¿›è¡Œé¡µé¢æ”¶é›†æ“ä½œï¼Œæˆ‘ä»¬æ›´å¤šçš„ä¼šé€‰æ‹©ç”¨è¡Œå†…æŸ¥è¯¢æ¥èŽ·å–ä¸€ä¸ªå±žæ€§ã€‚åŒæ—¶ï¼Œ**æŸ¥è¯¢ç±»åž‹ä¸èƒ½åœ¨å†…è”æŸ¥è¯¢ä¸­ä½¿ç”¨**ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾æ—§å¯ä»¥ä½¿ç”¨ [[lake-of-knowledge/10-Obsidian/Obsidianç¤¾åŒºæ’ä»¶/Dataview/DataviewåŸºæœ¬è¯­æ³•/24 - è¡¨è¾¾å¼\|è¡¨è¾¾å¼]].

> [!warning] æ³¨æ„
> ä½¿ç”¨è¿™ç§æŸ¥è¯¢æ—¶ï¼Œéœ€è¦åœ¨ Dataview è®¾ç½®ä¸­æ‰“å¼€ Enable Inline Queries è®¾ç½®ã€‚

è¡Œå†… DQL éœ€è¦å†™åœ¨è¡Œå†…ä»£ç ä¸­ï¼Œé€‚åˆå°èŒƒå›´åµŒå…¥å…ƒæ•°æ®ä½¿ç”¨ï¼›

- ä»¥ä¸€ä¸ªç­‰å·å¼€å¤´ï¼ŒåŽé¢è·Ÿéœ€è¦æ˜¾ç¤ºçš„å…ƒæ•°æ®ï¼›
- å¦‚æžœæ˜¯å½“å‰æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œç”¨ `this` æŒ‡ä»£ã€‚å¦‚æžœæ˜¯åˆ«çš„æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œç”¨é‚£ä¸ªæ–‡ä»¶çš„é“¾æŽ¥æŒ‡ä»£ï¼›

## åœ¨æ–‡ä¸­æ’å…¥ä¸€äº›è¡¨è¾¾å¼

- æ’å…¥ä¸€äº›ç®€å•çš„æ•°å­¦å¼å­

```
e â‰ˆ 2.7166666666666663
```

![Dataview çš„è¡Œå†… DQL ç¤ºä¾‹](https://cdn.pkmer.cn/images/Pasted%20image%2020230914212150.png!pkmer)

- åœ¨æ–‡ä¸­æ’å…¥ä¸€äº›æ—¥æœŸï¼Œæ¯”å¦‚åœ¨ä½ çš„èµ·å§‹é¡µä¸­ä½ å¯ä»¥åŠ ä¸Šä¸€äº›å€’è®¡æ—¶æˆ–è€…æ­£è®¡æ—¶ï¼ˆè¯¦è§ [[ç”¨ Dataview åˆ¶ä½œä¸€ä¸ªå€’è®¡æ—¶æˆ–è€…æ­£è®¡æ—¶åˆ—è¡¨\|ç”¨ Dataview åˆ¶ä½œä¸€ä¸ªå€’è®¡æ—¶æˆ–è€…æ­£è®¡æ—¶åˆ—è¡¨]]ï¼‰

```
ä»Šå¤©è¿˜å‰© 23466 ç§’ï¼Œä¹Ÿå°±æ˜¯ 391 åˆ†é’Ÿã€‚
è¿™å‘¨è¿˜å‰© 3.2715981249999997 å¤©ï¼Œä¹Ÿå°±æ˜¯ 391 åˆ†é’Ÿã€‚
```

## åœ¨æ–‡ä¸­æ’å…¥æœ¬æ–‡ä»¶çš„å…ƒæ•°æ®

éœ€è¦å€ŸåŠ©å…³é”®å­— `this` æŒ‡ä»£æœ¬æ–‡ä»¶ï¼Œç”¨ç‚¹è¿ç®—ç¬¦æŒ‡å‘æ–‡ä»¶çš„å…¶ä»–å…ƒæ•°æ®ã€‚ä¾‹å¦‚ä½ æƒ³åœ¨æ–‡ä¸­æŸå¤„æ’å…¥æ–‡ä»¶çš„åˆ›å»ºæ—¶é—´ï¼Œä½ å¯ä»¥è¿™æ ·å†™

```
åˆ›å»ºè¿™ç¯‡æ–‡ä»¶çš„æ—¥æœŸæ˜¯ï¼š2023-11-16T00:00:00.000+08:00.
```

![Dataview çš„è¡Œå†… DQL ç¤ºä¾‹](https://cdn.pkmer.cn/images/Pasted%20image%2020230914210037.png!pkmer)

å¦‚æžœæ ·å¼ä¸æ»¡æ„ï¼Œå¯ä»¥ç”¨ DQL çš„ `dateformat()` å‡½æ•°ä¿®æ”¹ä¿®æ”¹ï¼Œä¾‹å¦‚

```
åˆ›å»ºè¿™ç¯‡æ–‡ä»¶çš„æ—¥æœŸæ˜¯ï¼š2023/11/16.
or
åˆ›å»ºè¿™ç¯‡æ–‡ä»¶çš„æ—¥æœŸæ˜¯ï¼š2023å¹´11æœˆ16æ—¥æ˜ŸæœŸå›› ä¸­å›½æ ‡å‡†æ—¶é—´ 00:00.
```

![Dataview çš„è¡Œå†… DQL ç¤ºä¾‹](https://cdn.pkmer.cn/images/Pasted%20image%2020230914210058.png!pkmer)

æˆ‘ä»¬è¿˜å¯ä»¥åŠ ä¸€äº›å…¶ä»–å†…å®¹ï¼Œæ¯”å¦‚åŠ ä¸€ä¸ªå€’è®¡æ—¶ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªæ­£è®¡æ—¶

```
åˆ›å»ºè¿™ç¯‡æ–‡ä»¶çš„æ—¥æœŸæ˜¯ï¼š2023/11/16ï¼Œè·ç¦»ä»Šå¤©å·²ç» `= (date(today) - this.file.cday).day` å¤©è¾£ï¼
or
åˆ›å»ºè¿™ç¯‡æ–‡ä»¶çš„æ—¥æœŸæ˜¯ï¼š2023/11/16ï¼Œè·ç¦»ä»Šå¤©å·²ç» `= (date(today) - this.file.cday).day` å¤©è¾£ï¼
```

## åœ¨æ–‡ä¸­æ’å…¥å…¶ä»–æ–‡ä»¶çš„å…ƒæ•°æ®

æŸ¥è¯¢åˆ«çš„æ–‡ä»¶çš„å…ƒæ•°æ®ï¼šç”¨é“¾æŽ¥ä»£è¡¨é‚£ä¸ªæ–‡ä»¶ï¼ˆæ–¹æ‹¬å·å†…çš„ file æ›¿æ¢æˆç›®æ ‡æ–‡ä»¶çš„æ–‡ä»¶åï¼‰

```
`= [[filename]].file.name`
```

> [!tip] å°æŠ€å·§ï¼šä¿®æ”¹è¡Œå†…æŸ¥è¯¢çš„å‰ç¼€
> ä½ å¯ä»¥åœ¨ Dataview è®¾ç½®ä¸­çš„â€œä»£ç å—è®¾ç½®â€>â€œå†…è”æŸ¥è¯¢å‰ç¼€â€ä¸­å°† = æ›´æ”¹ä¸ºå¦ä¸€ä¸ªå‰ç¼€ (å¦‚ dv: æˆ–~)

## é…åˆ DQL çš„å‡½æ•°

å‰é¢æœ‰æåˆ°è¿‡é…åˆ `round()` å’Œ `dateformat()` ä½¿ç”¨ï¼Œè¿˜å¯ä»¥è€ƒè™‘ä¸€ä¸‹é…åˆå…¶ä»–çš„å‡½æ•°ï¼Œä¾‹å¦‚åˆ©ç”¨ `choice()` çš„é€‰æ‹©è¾“å‡ºã€åˆ©ç”¨ `truncat()` å‡½æ•°æˆªæ–­å­—ç¬¦ä¸²ã€åˆ©ç”¨ `default()` å‡½æ•°ä¸ºç»“æžœè®¾ç½®ä¸€ä¸ªåˆå§‹å€¼ã€åˆ©ç”¨ `length()` å‡½æ•°è®¡ç®—æ•°é‡ã€‚

- åˆ©ç”¨ `round(), trunc(), dateformat(), default()` è¿™ç±»å‡½æ•°ä»¥åŠç‚¹è¿ç®—ç¬¦å¯¹ç»“æžœåšä¿®æ­£ï¼š

```
ä»Šå¤©æ˜¯ **2023-11-16T00:00:00.000+08:00**ï¼ŒçŽ°åœ¨çš„æ—¶é—´æ˜¯ **17:11**ã€‚
```

![Dataview çš„è¡Œå†… DQL ç¤ºä¾‹](https://cdn.pkmer.cn/images/Pasted%20image%2020230916135258.png!pkmer)

è¿™é‡Œç”¨åˆ°äº† `dateformat()` å‡½æ•°æŠŠæˆ‘ä»¬çš„æ—¶é—´ä»¥ `HH:MM` çš„æ ¼å¼æ˜¾ç¤ºï¼›

```
è¿™ç¯‡ç¬”è®°å·²ç»å­˜åœ¨äº†ï¼š PT13M50.907Sï¼›
è¿™ç¯‡ç¬”è®°å·²ç»å­˜åœ¨äº†ï¼š 830.907 ç§’ï¼›
è¿™ç¯‡ç¬”è®°å·²ç»å­˜åœ¨äº†ï¼š 830.91 ç§’ï¼›
```

![Dataview çš„è¡Œå†… DQL ç¤ºä¾‹](https://cdn.pkmer.cn/images/Pasted%20image%2020230916140101.png!pkmer)

å¯¹æ¯”ä¸€ä¸‹ç›´æŽ¥è¾“å‡ºã€ç”¨ç‚¹è¿ç®—ç¬¦è¾“å‡ºå’Œç”¨ `round()` å‡½æ•°å››èˆäº”å…¥çš„ç»“æžœï¼Œé€‰æ‹©è‡ªå·±æœ€éœ€è¦çš„ä½¿ç”¨å³å¯ã€‚

- åˆ©ç”¨ `choice()` çš„é€‰æ‹©è¾“å‡ºç¤ºä¾‹ï¼š

```
è¿˜æ²¡è¾¾æ ‡ï¼ŒåŠ æ²¹!ðŸƒâ€â™‚ï¸
```

è¿™æ®µè¡Œå†…æŸ¥è¯¢ä»£ç ç”¨äº†ä¸€ä¸ª choice å‡½æ•°æ¥æ£€æµ‹å½“å‰æ–‡æ¡£ä¸­çš„â€œæ­¥æ•°â€å±žæ€§æœ‰æ²¡æœ‰è¾¾æ ‡ï¼Œä»Žè€Œé€‰æ‹©æ€§è¾“å‡ºæ–‡æœ¬ã€‚

```
ä»Šå¤©æ˜¯å·¥ä½œæ—¥ï¼ŒåŠªåŠ›å·¥ä½œå§!
```

è¿™æ®µè¡Œå†…æŸ¥è¯¢å¯ä»¥ç­›é€‰ä»Šå¤©æ˜¯ä¸æ˜¯å‘¨æœ«ï¼Œå¦‚æžœæ˜¯å‘¨æœ«åˆ™å‘ŠçŸ¥æ”¾æ¾ï¼Œåä¹‹åˆ™å‘ŠçŸ¥åŠªåŠ›å·¥ä½œã€‚

- åˆ©ç”¨ `length()` èŽ·å¾—æŸ¥è¯¢ç»“æžœçš„ä¸ªæ•°

æˆ‘ä»¬è¯´è¿‡ï¼Œè¡Œå†…æŸ¥è¯¢åªèƒ½è¾“å‡ºä¸€ä¸ªæŸ¥è¯¢ç»“æžœï¼Œ `length()` æŸ¥è¯¢çš„ç»“æžœé€šå¸¸ä¹Ÿæ˜¯å¯¹äºŽä¸€ä¸ªæ–‡ä»¶å†…çš„ã€‚ä¾‹å¦‚ä½ æƒ³çŸ¥é“â€œæœ¬æœˆä»»åŠ¡â€è¿™ä¸ªæ–‡ä»¶ä¸­æ‰€æœ‰æœªå®Œæˆçš„ä»»åŠ¡==çš„ä¸ªæ•°==ï¼Œä½ å¯ä»¥è¿™æ ·å†™

```
`=length(filter([[æœ¬æœˆä»»åŠ¡]].file.tasks, (t) => !t.completed))`
```
